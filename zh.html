<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>ç›¸ä¼¼æ€§æ£€æµ‹å™¨</title>
  <meta content="åœ¨çº¿æ–‡æœ¬ç›¸ä¼¼æ€§æ£€æµ‹å™¨" name="description">
  <meta content="æ–‡æœ¬ç›¸ä¼¼, ç›¸ä¼¼æ£€æµ‹, æŠ„è¢­æ£€æµ‹, å‰½çªƒæ£€æµ‹" name="keywords">
  <link rel="stylesheet" href="css/style.css">
  <!-- Favicons -->
  <link href="img/favicon.png" rel="icon">
  <link href="img/apple-touch-icon.png" rel="apple-touch-icon">
</head>

<body>
  <!-- contact -->
  <section class="w3l-contact-5">
    <div class="contact-top section-gap">
      <div class="wrapper">
        <div class="d-grid cont-main-top">
          <!-- contact form -->
          <div class="contacts12-main">
            <h3 class="title-main-cont">ç›¸ä¼¼æ€§æ£€æµ‹å™¨</h3>
            <p class="sub-title-cont" >è¿™æ˜¯ä¸€ä¸ªåŸºäº<a href="https://dl.acm.org/doi/10.1145/872757.872770">ç­›å­ç®—æ³•</a>çš„ç®€å•æ–‡æœ¬ç›¸ä¼¼æ€§æ£€æµ‹å™¨ã€‚æ£€æµ‹ç»“æœæ˜¯é€šè¿‡å‰ç«¯çš„ javascript æ¯”è¾ƒæ–‡æœ¬æŒ‡çº¹å¾—åˆ°çš„ï¼Œå› æ­¤ç½‘ç«™ä¸ä¼šå­˜å‚¨ä»»ä½•è®°å½•æˆ–æ•°æ®ã€‚è¯·æ”¾å¿ƒä½¿ç”¨ï¼</p>
            <a href="index.html">English</a> | ä¸­æ–‡ | <a href="https://haozheli.notion.site/d03e45ce3e4e44c99c78d1ce5dc844c0?pvs=4">å…³äº</a>
            <textarea id="text1" rows="10" cols="200" placeholder="åœ¨æ­¤è¾“å…¥æ‚¨çš„ç¬¬ä¸€ä¸ªæ–‡æœ¬ï¼Œç›®å‰åªæ”¯æŒè‹±æ–‡"></textarea>
            <textarea id="text2" rows="10" cols="200" placeholder="åœ¨æ­¤è¾“å…¥æ‚¨çš„ç¬¬äºŒä¸ªæ–‡æœ¬ï¼Œç›®å‰åªæ”¯æŒè‹±æ–‡"></textarea>
            <div class="text-center">
              <label for="sensitivity">è¯·é€‰æ‹©æ¨¡å‹ï¼š</label>
              <select id="sensitivity">
                <option value="0">ä¸¥æ ¼</option>
                <option value="4" selected>é»˜è®¤</option>
                <option value="10">å®½æ¾</option>
              </select>
              <br><br>
              <button onclick="runPlagiarismDetection()" class="btn btn-contact" id="myButton">å¼€å§‹æ£€æµ‹</button>
            </div>
          </div>
          <!-- //contact form -->
          <!-- contact address -->
          <div class="contact">
            <div class="cont-subs">
              <div class="cont-add">
                <h4>æŠ„è¢­</h4>
                <p id="result">æ˜¯å¦å­˜åœ¨æŠ„è¢­</p>
              </div>
              <div class="cont-add">
                <h4>çª—å£å¤§å°</h4>
                <p id="windowsize">ç”¨äºæ£€æµ‹çš„çª—å£å¤§å°</p>
              </div>
              <div class="cont-add">
                <h4>ç›¸ä¼¼æ€§</h4>
                <p id="fg">ä¸¤æ®µæ–‡æœ¬çš„æŒ‡çº¹äº¤é›†ç™¾åˆ†æ¯”</p>
              </div>
              <a href="zh.html" id="myLink">é‡æ–°å¼€å§‹</a>
            </div>
          </div>
          <!-- //contact address -->
          <p>&copy 2023 <a href="https://www.haozheli.com" target="_blank">Haozhe Li</a>. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</p>
      </div>
      <!-- map -->
      <!-- //map -->
    </div>
  </section>

  <!-- Detector Code -->
  <script>
    // JavaScript code goes here
    // ...

    // Preprocess the text: tokenize and convert to lowercase
    function preprocessText(rawText) {
      let tokens = [];
      let token = "";
    
      for (let i = 0; i < rawText.length; i++) {
        let c = rawText[i];
        
        if (/[a-zA-Z0-9]/.test(c) || /[\u4e00-\u9fa5]/.test(c)) {
          if (/[A-Z]/.test(c)) {
            token += c.toLowerCase();
          } else {
            token += c;
          }
        } else if (token !== "") {
          tokens.push(token);
          token = "";
        }
      }
    
      if (token !== "") {
        tokens.push(token);
      }
    
      return tokens;
    } 
  
  // Create windows from the processed text
  function createWindows(processedText, windowSize) {
    let windows = [];
    for (let i = 0; i <= processedText.length - windowSize; i++) {
        let window = "";
        for (let j = i; j < i + windowSize; j++) {
            window += processedText[j];
            // Only add a space if it's not the last word in the window
            if (j < i + windowSize - 1) {
                window += " ";
            }
        }
        windows.push(window);
    }
    return windows;
  }

  // Hash the windows using a simple hash function (you should replace this with a better hash function)
  function hashWindows(windows) {
    let hashes = [];
    for (let i = 0; i < windows.length; i++) {
        let hash = 0;
        for (let j = 0; j < windows[i].length; j++) {
            let c = windows[i].charCodeAt(j);
            hash = 31 * hash + c;
        }
        hashes.push(hash);
    }
    return hashes;
  }

  
  // Get the fingerprints from the hashes
  function getFingerprints(hashes) {
      let fingerprints = new Set();
      for (let i = 0; i < hashes.length; i++) {
      fingerprints.add(hashes[i]);
      }
      return fingerprints;
  } 
  
    let percentage = 0;
    const sensitivitySelect = document.getElementById('sensitivity');
    let sensitivity = 4;
    sensitivitySelect.addEventListener('change', function () {
        const selectedValue = sensitivitySelect.value;
        sensitivity = parseInt(selectedValue);
    });

    // Detect plagiarism by comparing the fingerprints
  function detectPlagiarism(fingerprints1, fingerprints2) {
    let intersection = new Set([...fingerprints1].filter(x => fingerprints2.has(x)));
    let intersectionSize = intersection.size;
    let union = new Set([...fingerprints1, ...fingerprints2]);
    let unionSize = union.size;
    let similarity = intersectionSize / unionSize;
    percentage = similarity * 100;
    return percentage > sensitivity;
  }



  function runPlagiarismDetection() {
    // Get the input text from the textboxes
    let text1 = document.getElementById("text1").value;
    let text2 = document.getElementById("text2").value;
    //document.getElementById("size1").innerText = text1.length;
    //document.getElementById("size2").innerText = text2.length;

    // Preprocess the texts
    let processedText1 = preprocessText(text1);
    let processedText2 = preprocessText(text2);

    let windowSize = text1.length < text2.length ? Math.floor(text1.length / 10) : Math.floor(text2.length / 10);
    if (windowSize < 1) {
      windowSize = 1;
    }
    if (windowSize > 100) {
      windowSize = 100;
    }

    document.getElementById("windowsize").innerText = windowSize;

    // Create windows
    let windows1 = createWindows(processedText1, windowSize);
    let windows2 = createWindows(processedText2, windowSize);

    // Hash the windows
    let hashes1 = hashWindows(windows1);
    let hashes2 = hashWindows(windows2);

    // Get the fingerprints
    let fingerprints1 = getFingerprints(hashes1);
    let fingerprints2 = getFingerprints(hashes2);

    // Detect plagiarism
    let isPlagiarized = detectPlagiarism(fingerprints1, fingerprints2);
    document.getElementById("fg").innerText = Math.floor(percentage) + "%";

// Display the result
    document.getElementById("result").innerText = isPlagiarized ? "å­˜åœ¨" : "ä¸å­˜åœ¨";
  }
  
  </script>

  <!--Confirm code-->
  <script>
    const myLink = document.getElementById('myLink');
    myLink.addEventListener('click', function (event) {
        event.preventDefault();
        const confirmed = confirm("ç¡®å®šè¦é‡æ–°å¼€å§‹å—ï¼Ÿ");
        if (confirmed) {
            window.location.href = myLink.getAttribute('href');
        }
    });
      myButton.addEventListener('click', function () {
        alert("æ£€æµ‹ç»“æœæˆåŠŸç”Ÿæˆã€‚");
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
  <script>
    function addDarkmodeWidget() {
      const options = {
        bottom: '64px', // default: '32px'
        right: 'unset', // default: '32px'
        left: '32px', // default: 'unset'
        time: '0.5s', // default: '0.3s'
        mixColor: '#fff', // default: '#fff'
        backgroundColor: '#fff',  // default: '#fff'
        buttonColorDark: '#100f2c',  // default: '#100f2c'
        buttonColorLight: '#fff', // default: '#fff'
        saveInCookies: true, // default: true,
        label: 'ğŸŒ“', // default: ''
        autoMatchOsTheme: true // default: true
      }
      
      const darkmode = new Darkmode(options);
      darkmode.showWidget();
    }
    window.addEventListener('load', addDarkmodeWidget);
  </script>
</body>

</html>
